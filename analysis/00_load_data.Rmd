---
title: "Ancestry classifier with principal components"
output: html_notebook
---

```{r setup, warning = F}
library(tidyverse)
library(adegenet)
library(magrittr)
```


```{r}
dat <- adegenet::read.PLINK("../data/acs_mini_project.raw")
labels <- readr::read_delim("../data/acs_mini_project_labels.txt")
inds <- grep("", labels$ancestry)

tbl <- as.matrix(dat[inds,])
rownames(tbl) <- paste0("TGG_",rownames(tbl))

eval <- read.table("../data/amp.eval")
evec1.pc <- round(eval[1,1]/sum(eval)*100,digits=2)

evec <- read.table("../data/amp.pca.evec", skip = 1)
colnames(evec) <- c("sample_id", paste0("pca_", seq(60)), "pop")
evec %<>% dplyr::mutate(sample_id = gsub(":", "_", sample_id)) %>% 
  dplyr::left_join(labels, by = "sample_id") %>% dplyr::select(-pop)
```

```{r impute tbl}

```
